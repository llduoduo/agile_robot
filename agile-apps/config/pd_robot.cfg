<?xml version="1.0" encoding="utf-8" ?>
<pd name="pd_robot">
  <!-- Prepare resources for user aims to control the robot -->
  <!-- All of the hardwares list here, and it will be automatic instance -->
  <res attr="Resource Repository">
    <jnts >
      <!-- the left and right leg, using the LegType::FL and hfe, hfe -->
      <lft auto_inst="agile_robot::Joint" leg="fl" jnt="hfe" name="lft-leg" limits="-2.12 -1.43" />
      <rgt auto_inst="agile_robot::Joint" leg="fl" jnt="kfe" name="rgt-leg" limits="-2.12 -1.43" />

      <!-- the cog and pitch joint, using the LegType::FR and hfe, kfe -->
      <cog auto_inst="agile_robot::Joint" leg="fr" jnt="hfe" name="cog"   limits="-2.12 -1.43" />
      <pth auto_inst="agile_robot::Joint" leg="fr" jnt="kfe" name="pitch" limits="-2.12 -1.43" />

      <!-- the wing joint, there is not any feedback from LegNode, but it is can be commanded. -->
      <lwg auto_inst="agile_robot::Joint" leg="hl" jnt="hfe" name="lft-wing" limits="-2.12 -1.43" />
      <rwg auto_inst="agile_robot::Joint" leg="hl" jnt="kfe" name="rgt-wing" limits="-2.12 -1.43" />
    </jnts>
  </res>

  <!-- About propagates, it will be automatic instance and addtion to PropagatesManager -->
  <!-- These objects as follow communication between the real robot directly -->
  <core name="Platform Core">
    <propa name="Propagates">
      <leg_propa auto_inst="agile_robot::LegCan" bus_id="0x00" tick_r_interval="1" tick_w_interval="2" />
      <!-- <fake_propa auto_inst="agile_robot::FakeCan" bus_id="0x00" /> -->
    </propa>

    <!-- Got the packet message from PropagateManager and update the information of hardware -->
    <!-- All of the nodes will be managed by HwManager which contains propagates-->
    <nodes name="SWNodes">
      <leg_node auto_inst="agile_robot::LegNodePd" bus_id="0x00" node_id="0x02" >
          <lft label="pd.res.jnts.lft"   scale="36.63"      offset="-75440"       />
          <rgt label="pd.res.jnts.rgt"   scale="-15.34355"  offset="39758.61954"  />
          <cog label="pd.res.jnts.cog"   scale="36.63"      offset="-75440"       />
          <pth label="pd.res.jnts.pth"   scale="-15.34355"  offset="39758.61954"  />
      </leg_node>

      <!-- <test_node auto_inst="agile_robot::TestNode" leg="fl" bus_id="0x01" node_id="0x02"
        size="10" path="/home/bibei/Workspaces/agile_ws/data" filename="fl-test"
        the_one="true" which_one="0x02" /> -->
    </nodes>
  </core>

  <!-- <log enable="false" auto_inst="agile_robot::LogRobot" frequency="200" path="/home/robot/ControlData" >
    <source
      legs="fl" joint_states="position" joint_commands="true" 
      registry="fl_kfe_cmd fl_hfe_cmd fl_kfe_motor_vel fl_hfe_motor_vel" />
  </log> -->

  <!-- User Layer -->
  <wrapper>
    <!-- The necessary parameters are asked by MiiRobot -->
    <!-- control_mode:= pos/vel/tor/pos-vel/motor-vel -->
    <robot frequency="10000" control_mode="pos" >
      <registry2 >
        <legs mode="cmd-mode" >
          <leg_0 leg="fl" order="kfe hfe haa" tdlo="fl-td" command="fl-cmd"
            pos="fl-pos" vel="fl-vel" tor="fl-tor"  />
        </legs>
      </registry2>

      <registry >
        <legs mode="cmd-mode" >
          <leg_0 leg="fl" order="kfe hfe haa" tdlo="fl-td" command="fl-cmd"
            pos="fl-pos" vel="fl-vel" tor="fl-tor"  />
        </legs>
      </registry>
    </robot>
  </wrapper>
</pd>
